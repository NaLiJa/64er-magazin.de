#RetroDevStudio.MetaData.BASIC:2049,BASIC V2,lowercase,10,10
10 REM********************************* 
20 REM********************************* 
30 REM*****      ARNE WEITZEL      **** 
40 REM*****                        **** 
50 REM***** RITTER-VON-HALT-STR.17 **** 
60 REM*****                        **** 
70 REM*****    5608 RADEVORMWALD   **** 
80 REM********************************* 
90 REM*********************************
100 DIM F$(100,11),SU$(11),NA$(11):POKE 788,52 
110 SI=54272:FL=SI:FH=SI+1:TL=SI+2:TH=SI+3:WW=SI+4:AA=SI+5:HH=SI+6:VL=SI+24 
120 NA$(1)="AME":NA$(2)="ORNAME":NA$(3)="EBURTSTAG":NA$(4)="EBURTSMONAT" 
130 NA$(5)="EBURTSJAHR":NA$(6)="TRASSE":NA$(7)="AUSNUMMER" 
140 NA$(8)="OSTLEITZAHL":NA$(9)="OHNORT":NA$(10)="ORWAHL":NA$(11)="ELEFON"

150 REM********* M E N U E ************* 
160 POKE 198,0:PRINT CHR$(142):POKE 53280,12:POKE 53281,3
170 PRINT ""TAB(11)""
180 PRINT TAB(11)""TAB(27)""
190 PRINT TAB(11)""
200 PRINT""TAB(13)"PERSONENDATEI"
210 PRINT TAB(7)""
220 FOR I=1 TO 13:PRINT TAB(7)""TAB(32)"":NEXT I
230 PRINT TAB(7)""
240 PRINT""TAB(9)"AUSGABEN          : F1"
250 PRINT TAB(9)"EINGABE           : F3"
260 PRINT TAB(9)"SUCHEN            : F5"
270 PRINT TAB(9)"DATEN EINLESEN    : F7"
280 PRINT TAB(9)"DATEN SPEICHERN   : F2"
290 PRINT TAB(9)"DATEI VORBEREITEN : F4"
300 PRINT TAB(9)"ENDE              : F6"
310 GET E$:IF E$="" THEN 310
320 IF(ASC(E$)<133) OR (ASC(E$)>139) THEN 310 
330 MO=ASC(E$)-131:ON MO GOTO 170,450,360,1180,990,1050,2020,340
340 PRINT"";:CLR:RESTORE:POKE 53280,14:POKE 53281,6:END

350 REM********** EINGABE ************* 
360 MO$=" :":F3=151:F4=151:POKE 53280,15:POKE 53281,12:PRINT CHR$(F3)
370 PRINT"":GOSUB 830:PRINT CHR$(F4):GOSUB 970
380 FOR J=1 TO 11:GOSUB 1860:SYS 58640
390 GOSUB 680:F$(AN+1,J)=A$:NEXT:AN=AN+1
# ==> "EITERE"
400 GOSUB1110: GOSUB 1640: PRINT:PRINT"EITERE INGABE (-/N)";
410 GETW$:IFW$=""THEN410 
420 IFW$="N"THEN160
430 GOTO 360

440 REM********** AUSGABE *************
450 POKE 53280,14:POKE 53281,14
460 PRINT""TAB(15)"AUSGABE :"
470 PRINT TAB(10)"F1 - SORTIERT"
# ==> "PHYSIKALISCH"
480 PRINT TAB(10)"F3 - PHYSIKALISCH"
490 GET AU$:IF (AU$="") OR (AU$<>"" AND AU$<>"") THEN 490
500 Z=0:GOSUB 2000 
510 IF AU$="" THEN 590
520 Z=Z+1:IF Z>AN THEN GOSUB 610:GOTO 160
530 PRINT "":IF F$(Z,0)="@" THEN 520
540 GOSUB 630:GOSUB 1640
# ==> "EITERE"
550 PRINT"EITERE USGABEN ? (-/N)";
560 GET W$:IF W$="" THEN 560
570 IF W$="N" THEN 160
580 GOTO 520
590 MA=Z:Z=VAL(F$(Z,0)):IF Z=0 THEN GOSUB 610:GOTO 160 
600 PRINT"":GOSUB 630:GOTO 1490
# ==> "WEITEREN"
610 PRINT"EINE WEITEREN ERSONEN ERFASST !":GOSUB 1640
620 FOR I=1 TO 3000:NEXT:RETURN
630 POKE 53280,F1:POKE 53281,F2:PRINT CHR$(F3):GOSUB 830
640 PRINT ""TAB(25)"ATENSATZ "Z;CHR$(F4)
650 FOR J=1 TO 11:GOSUB 1860:SYS 58640  
660 PRINT F$(Z,J):NEXT J:RETURN

670 REM************ INPUT ************
680 LL=0:A$="":POKE 204,0
690 GET AA$:IF AA$="" THEN 690
700 IF ASC(AA$)<>13 THEN 730
710 IF LL=0 THEN 690
720 PRINT "";:POKE 204,1:RETURN
730 IF ASC(AA$)<>20 THEN 760
740 IF LL=0 THEN 690
750 PRINT "";:A$=LEFT$(A$,LEN(A$)-1):LL=LL-1:GOTO 690
760 IF AA$<>"" THEN 780
770 GOTO 800
780 PRINT AA$;:A$=A$+AA$:LL=LL+1
790 IF LL<L THEN 690
800 IF PEEK(207) THEN 800
810 POKE 204,1:RETURN

820 REM********** 1.MASKE **************
830 PRINT CHR$(14):PRINT""MO$
840 PRINT"";:FOR I=1 TO 35:PRINT" ";:NEXT I:PRINT
850 FOR I=1 TO 5:PRINT TAB(1)" "TAB(35)" ":NEXT I
860 PRINT"";:FOR I=1 TO 35:PRINT" ";:NEXT I
870 PRINT"AME    :":PRINT"ORNAME :"
880 PRINT"EBOREN :.."
890 PRINT"OHNHAFT :"
900 PRINT"TR.:";
910 PRINT TAB(27)"R.:"
920 PRINT"LZ :";
930 PRINT TAB(13)"RT :"
940 PRINT"ELEFON :/"
950 RETURN

960 REM********* 2.MASKE **************
970 FOR J=1 TO 11:GOSUB 1860:SYS 58640:FOR I=1 TO L:PRINT"";:NEXT I,J:RETURN

980 REM********** EINLESEN ************
# ==> "@:" ENTFERNT
990 PRINT""TAB(15)" EINLESEN ":I=0:OPEN 1,8,2,"ADR.-DATEI,S,R"
1000 FOR J=0 TO 11
1010 INPUT#1,F$(I,J)
1020 NEXT:IF ST<>64 THEN I=I+1:GOTO 1000
1030 CLOSE 1:AN=I:GOTO 160

1040 REM*********** SPEICHERN *********
1050 PRINT""TAB(15)" SPEICHERN ":OPEN 1,8,2,"@:ADR.-DATEI,S,W"
1060 FOR I=0 TO AN
1070 FOR J=0 TO 11
1080 PRINT#1,F$(I,J)
1090 NEXT J,I:CLOSE 1:GOTO 160

1100 REM********* EINSORTIEREN ********
1110 MA=0:VZ=VAL(F$(0,0)):ZZ =VZ
1120 IF VZ=0 THEN 1160 
1130 MB=MA:MA=VZ:VZ=VAL(F$(MA,0))
1140 IF(F$(MA,1)<F$(AN,1))OR((F$(MA,1)=F$(AN,1))AND(F$(MA,2)<F$(AN,2)))THEN1120
1150 F$(AN,0)=STR$(MA):F$(MB,0)=STR$(AN):RETURN
1160 F$(AN,0)="0":F$(MA,0)=STR$(AN):RETURN

1170 REM********** SUCHEN *************
1180 POKE 53280,14:POKE 53281,7:PRINTCHR$(14)
1190 PRINT"";:GOSUB 1990
1200 PRINT"                 :                "
1210 PRINT"ONACH SOLL GESUCHT WERDEN ?"
1220 FOR J=1 TO 11:PRINT"- ";NA$(J)TAB(20)":";
1230 IF J=10 THEN PRINT" 0":GOTO 1260 
1240 IF J=11 THEN PRINT" +":GOTO 1260 
1250 PRINT J
1260 NEXT J
1270 GET E$:IF E$="" THEN 1270 
1280 IF (ASC(E$)<48 OR ASC(E$)>57) AND (E$<>"+") THEN 1270 
1290 IF E$="0" THEN SU=10:GOTO 1320 
1300 IF E$="+" THEN SU=11:GOTO 1320 
1310 SU=ASC(E$)-48 
1320 J=SU:GOSUB 1860
1330 PRINT""NA$(SU)
1340 INPUT"";SU$(SU):IF LEN(SU$(SU))=0 THEN 1340
1350 IF LEN(SU$(SU))>1 THEN GOSUB 1370:GOTO 1340 
1360 GOTO 1400 
1370 GOSUB 1640:FOR I=1 TO 4
1380 PRINT"   !":FOR J=1 TO 200:NEXT J
1390 PRINT"                 ":FOR J=1 TO 200:NEXT J,I:RETURN 
1400 GF=0:Z=0 
1410 IF VAL(F$(Z,0))<>0 THEN GOTO 1460
1420 IFGF=0THENPRINT"EINE ENTSPRECHENDEN ERSONEN ERFASST !":GOTO 1450
1430 PRINT"EITERE, FUER DAS UCHKRITERIUM         ZUTREFFENDE";
1440 PRINT"ERSONEN NICHT ERFASST !"
1450 GOSUB 1640:FOR I=1 TO 5000:NEXT I:GOTO 160 
1460 MA=Z:Z=VAL(F$(Z,0)) 
1470 IF F$(Z,SU)<>SU$(SU) THEN 1410 
1480 PRINT"":GOSUB 630:GF=1
1490 GOSUB 1640:PRINT"EITER"M2$;TAB(18)" - F1"
1500 PRINT"NDE "M1$;TAB(18)" - F3"
1510 PRINT"OESCHEN"TAB(18)" - F5"
1520 PRINT"ENDERN"TAB(18)" - F7";
1530 GET W$:IF W$="" THEN 1530
1540 LA=ASC(W$)-132: IF (LA<1) OR (LA>4) THEN 1530 
1550 IF MO=2 THEN ON LA GOTO 590,160,1590,1730 
1560 ON LA GOTO 1410,160,1580,1720

1570 REM********** LOESCHEN ***********
1580 PRINT"OESCHEN :":PRINT"ATENSATZ "Z" : ";F$(Z,1)" , "F$(Z,2)
1590 Z1$=F$(Z,0):F$(Z,0)="@"
# ==> Z1$ 
1600 F$(MA,0)=Z1$ 
1610 FOR W=1 TO 3000:NEXT 
1620 Z=MA:GOTO 1800

1630 REM************** TON ************  
1640 POKE VL,15 
1650 POKE AA,2*16+3 
1660 POKE TL,0:POKE TH,8 
1670 POKE HH,15*16+2 
1680 POKE FH,62:POKE FL,5 
1690 POKE WW,65:FOR I=1 TO 100:NEXT I:POKE WW,64 
1700 RETURN

1710 REM********** AENDERN ************
1720 MO$=" :":F1=9:F2=9:F3=155:F4=5
1730 PRINT"":GOSUB 970:GOSUB 630:PRINT TAB(8)"+KEINE ENDERUNGEN - F7+"
1740 POKE 198,0
1750 FOR J=3 TO 11:GOSUB 1860:SYS58640:GOSUB 680:IF AA$<>"" THEN F$(Z,J)=A$
1760 NEXT J
1770 PRINT:GOSUB 1640:PRINT"ENDERUNGEN ORREKT ? (-/N)";
1780 GET W$:IF W$="" THEN 1780
1790 IF W$="N" THEN 1730
1800 PRINT"EITER"M2$" (-/N)"
1810 GET W$:IF W$="" THEN 1810
1820 IF W$="N" THEN 160
1830 IF MO=4 THEN GOSUB 1990:GOTO 1410 
1840 GOSUB 2000:GOTO 610

1850 REM********* PRINT AT ************ 
1860 ON J GOTO 1870,1880,1890,1900,1910,1920,1930,1940,1950,1960,1970
1870 L=21:SP=13:ZE=5 :GOTO 1980 
1880 L=21:SP=13:ZE=7 :GOTO 1980 
1890 L=2 :SP=11:ZE=11:GOTO 1980 
1900 L=2 :SP=14:ZE=11:GOTO 1980 
1910 L=4 :SP=17:ZE=11:GOTO 1980 
1920 L=18:SP=7 :ZE=15:GOTO 1980 
1930 L=4 :SP=33:ZE=15:GOTO 1980 
1940 L=5 :SP=7 :ZE=17:GOTO 1980 
1950 L=18:SP=19:ZE=17:GOTO 1980 
1960 L=5 :SP=11:ZE=19:GOTO 1980 
1970 L=6 :SP=17:ZE=19:GOTO 1980
1980 POKE214,ZE:POKE 211,SP:RETURN
1990 MO$=" :":ML$="UCHEN ":M2$="SUCHEN" :F1=14:F2=6:F3=155:F4=158:RETURN
2000 MO$=" :":ML$= "USGABEN": M2$= "E USGABEN":F1=14:F2=11:F3=155
2010 F4=5:RETURN
2020 PRINT""TAB(10)" DATEI VORBEREITEN "
2030 F$(0,0)="0":FOR J =1 TO 11:F$(0,J)="-":NEXT J
2040 OPEN 1,8,2,"ADR.-DATEI,S,W"
2050 FOR J=0 TO 11 
2060 PRINT#1,F$(0,J) 
2070 NEXT J:CLOSE 1:GOTO 160    


 




























































# ""
# ""         






















  



















 